# 🎓 智能作业批改系统 Pro - 用户手册

## 🌟 功能概览

本系统已升级为 **SaaS 多租户协作平台**，支持高效的作业自动批改、班级管理和多教师协同阅卷。

1.  **多题型支持**：支持单选、多选、判断、填空（客观题）以及问答、论述（主观题）。
2.  **智能批改**：
    *   **客观题**：基于标准答案自动比对批改。
    *   **主观题**：接入 DeepSeek/OpenAI/Gemini 等大模型，提供拟人化评分和详细评语。
3.  **班级管理**：支持导入学生花名册，自动匹配答卷与学生信息。
4.  **协同阅卷**：支持将试卷分块（Section）分配给不同教师流水线阅卷。
5.  **数据可视化**：提供班级得分率分析、总分分布图和详细成绩表。
6.  **历史归档**：成绩保存至数据库，随时回溯历史记录。

---

## 🚀 操作指南

### 🔐 登录与注册
系统现已启用身份认证。
1.  **登录**：使用管理员分配的账号密码登录。
2.  **多租户**：系统根据您的账号自动识别所属学校（租户），确保数据隔离。

### 第一步：🏫 班级与学生管理 (New!)
在 **"班级管理 (Classes)"** 页面维护您的教学班级。
1.  **创建班级**：点击 "Add Class"，输入班级名称（如 `高三(1)班`）。
2.  **导入名单**：点击 "Import Roster"，上传 Excel/CSV 文件（需包含 `Name` 和 `Student Number` 列）。
    *   *作用*：系统在解析答卷时，会自动根据学号/姓名匹配数据库中的学生，修正 OCR 识别错误。

### 第二步：📝 考试配置与任务分配
在 **"考试设置"** 页面配置考试结构。

1.  **考试名称**：输入本次考试的唯一标识。
2.  **题型配置**：定义大题结构（如 `Section 1: 选择题`）。
3.  **任务分配 (New!)**：
    *   进入 **"任务分配 (Tasks)"** 页面。
    *   选择考试，点击 **"Sync Sections"** 同步试卷结构。
    *   将不同的 Section 分配给指定的阅卷老师（如：张老师改第一题，李老师改作文）。

### 第三步：🤖 LLM 配置 (仅主观题需要)
如果考试包含主观题，请在左侧边栏配置：
1.  **API Key**：输入您的 LLM 服务商 API Key。
2.  **Base URL**：API 服务地址。
3.  **模型名称**：选择使用的模型。

### 第四步：📂 答卷上传与批改
在 **"答卷上传"** 页面上传文件。

#### 1. 上传标准答案
上传 `.txt` 文件，包含所有题目的标准答案。

#### 2. 上传学生答卷
批量上传学生的 `.txt` 答卷文件。
*   **异步处理 (New!)**：上传和解析过程现由后台异步任务队列处理，支持大规模并发上传。

#### 3. 协同阅卷 (New!)
*   **我的任务**：教师登录后，系统会自动筛选出 **"分配给我的待办题目"**。
*   **流水线作业**：您只需关注自己负责的题目，其他题目由同事处理。

---

## 📊 结果查看

### 批改结果
*   **概览**：查看平均分、及格率、最高分等核心指标。
*   **图表**：查看各大题得分率柱状图和总分分布直方图。
*   **详细数据**：交互式表格展示每位学生的详细得分。

### 主观题详情
*   按学生折叠展示，查看每道主观题的 **学生答案** vs **参考答案**。
*   查看 LLM 给出的 **具体得分** 和 **详细评语/扣分理由**。

---

## 💡 进阶功能

### 少样本学习 (Few-Shot)
在 **"考试设置"** 页面，展开 **"🧠 主观题少样本示例配置"**，录入典型的好/坏答案示例，教 LLM 对齐您的评分标准。

### 部署与运维
系统支持 Docker 容器化部署，包含：
*   **MySQL**：数据持久化。
*   **Redis**：缓存与消息队列。
*   **MinIO**：高性能对象存储（替代本地文件存储）。
*   **Celery**：异步任务处理引擎。
