# 智能阅卷系统功能文档 (SaaS版)

## 1. 系统概述
智能阅卷系统 (Intelligent Exam Grading System) 已升级为支持 **多租户、多用户协作** 的 SaaS 平台。旨在通过自动化和 AI 技术简化考试阅卷流程，支持学校级统一管理、班级名单维护及流水线协同阅卷。

## 2. 功能模块图

```mermaid
graph TD
    User([教师 / 管理员]) --> Frontend[前端 SPA (Vue3)]
    
    subgraph "应用层 (Docker Containers)"
        API[后端 API (FastAPI)]
        Worker[异步任务 Worker (Celery)]
    end
    
    subgraph "数据存储层"
        MySQL[(MySQL 8)]
        Redis[(Redis 7 - 缓存/队列)]
        MinIO[(MinIO - 对象存储)]
    end
    
    Frontend -->|REST API| API
    API --> MySQL
    API --> Redis
    API --> MinIO
    
    API -->|Task| Worker
    Worker --> Redis
    Worker --> MySQL
    Worker --> LLM_Service[外部 LLM API]
```

## 3. 详细功能说明

### 3.1 核心架构升级 (New!)
*   **身份认证**：基于 JWT 的用户登录与鉴权体系。
*   **多租户隔离**：基于 `School ID` 的数据隔离，支持多所学校共用一套系统。
*   **异步处理**：引入 Celery + Redis，将耗时的 OCR 解析和 LLM 批改任务放入后台队列，提升系统响应速度。
*   **对象存储**：集成 S3/MinIO 存储答卷图片和文件，支持海量数据。

### 3.2 班级与学生管理 (Class Management - New!)
*   **班级维护**：创建、编辑班级信息。
*   **名单导入**：支持 Excel/CSV 批量导入学生花名册。
*   **智能匹配**：阅卷时自动将 OCR 识别的学号/姓名与数据库名单比对，纠正识别错误，确保成绩归属准确。

### 3.3 协同阅卷 (Collaborative Grading - New!)
*   **试卷分块**：将一张试卷按大题 (Section) 拆分。
*   **任务分配**：管理员可将不同 Section 分配给指定的阅卷教师。
*   **我的待办**：教师仅需关注分配给自己的题目，系统自动筛选未批改记录。

### 3.4 原有核心功能
*   **系统配置**：灵活配置试卷结构、标准答案及 LLM 参数。
*   **答卷上传**：支持批量上传答卷，自动解析。
*   **客观题阅卷**：自动比对标准答案，一键出分。
*   **主观题阅卷**：AI 辅助批改，提供评分建议与详细评语。
*   **结果分析**：生成成绩报表、分布图，支持 Excel 导出与历史归档。

## 4. 推荐工作流 (SaaS模式)

1.  **基础数据**：教务管理员在`班级管理`导入学生名单。
2.  **考试配置**：创建考试，上传标准答案，并在`任务分配`页设定各题目的阅卷老师。
3.  **答卷录入**：上传学生答卷，系统后台异步解析并匹配学生库。
4.  **协同阅卷**：
    *   **客观题**：系统自动完成。
    *   **主观题**：各位老师登录系统，在`主观题阅卷`页处理“我的任务”。
5.  **成绩发布**：所有题目批改完毕后，管理员发布成绩报表。
